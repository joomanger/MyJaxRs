<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <title>Управление заказами BETA</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <link
            href="${facesContext.externalContext.requestContextPath}/resources/css/default.css"
            rel="stylesheet" type="text/css" />
        <link
            href="${facesContext.externalContext.requestContextPath}/resources/css/cssLayout.css"
            rel="stylesheet" type="text/css" />
    </h:head>
    <h:body>
        <p:growl id="mainMSG" autoUpdate="true"/>
        <div>
            <div id="top" class="top">
                <ui:insert name="top">
                    <h:form>
                        <h1><h:link value="Управление заказами" outcome="/index.xhtml"/></h1>
                        Учетная запись: #{sessionActions.currentUser.fullName}
                    </h:form>
                </ui:insert>
            </div>
            <div>
                <div id="left">
                    <ui:insert name="left">
                        <h:form>
                            <p:menu toggleable="true">
                                <p:menuitem oncomplete="PF('areYouSure').show()" value="Выход"/>
                                <p:submenu label="Справочники">
                                    <p:menuitem action="/client/item/items" value="Позиции" />
                                </p:submenu> 
                                <p:submenu label="Заказы">
                                    <p:menuitem action="newOrder" outcome="newOrder" value="Создать заказ"/>
                                    <p:menuitem action="/client/saleorders/orders" value="Заказы"/>
                                </p:submenu>
                                <p:submenu label="Конфигурация номенклатуры">
                                    <p:menuitem action="/client/config/param/params" value="Параметры конфигурации"/>
                                    <p:menuitem action="/client/config/configs" value="Конфигурации"/>
                                </p:submenu>
                                <p:submenu label="Администратор">
                                    <p:menuitem action="/client/sys/user/users" value="Пользователи"/>
                                    <p:menuitem action="/client/sys/role/roles" value="Роли"/>
                                    <p:menuitem action="/client/sys/menu/menus" value="Меню"/>
                                    <p:menuitem action="/client/sys/view/views" value="Представления"/>
                                </p:submenu>
                                <c:forEach var="role" items="#{userCBean.findUserByUserName(request.remoteUser).roles}">
                                    <c:forEach var="menu" items="#{role.menus}">
                                        <p:submenu label="#{menu.menuName}">
                                            <c:forEach var="item" items="#{menu.menuItems}">
                                                <c:if test="#{(item.visibleItem) and (menu.activeStatus)}">
                                                    <c:set var="view" value="#{viewCBean.findViewById(item.view_id)}"/>
                                                    <p:menuitem action="#{view.getUrl()}" value="#{item.menuItem}"/> 
                                                </c:if>
                                            </c:forEach>  
                                        </p:submenu>
                                    </c:forEach>
                                </c:forEach>
                            </p:menu>

                            <p:dialog header="Are you Sure?" widgetVar="areYouSure" modal="true" showEffect="fade" hideEffect="fade" resizable="false" width="400">
                                <p:outputPanel id="selectedParams" style="text-align:center;">
                                    <p:commandButton value="Yes" action="#{sessionActions.logout()}" oncomplete="PF('areYouSure').hide()"/>
                                    <p:commandButton oncomplete="PF('areYouSure').hide()" immediate="true" value="No"/>
                                </p:outputPanel>
                            </p:dialog>
                        </h:form>
                    </ui:insert>
                </div>
                <div id="content" class="left_content" style="position: absolute">
                    <ui:insert id="qqq" name="content">Content</ui:insert>
                </div>
            </div>
        </div>
    </h:body>
</html>