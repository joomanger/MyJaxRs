<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

    <body>

        <ui:composition template="./../WEB-INF/template.xhtml">
            <ui:define name="content">
                <h:form prependId="false">
                    <p:steps style="width: 1200px" activeIndex="0" styleClass="custom" readonly="false" >
                        <p:menuitem value="Основные данные" action="newOrder" url="newOrder" />
                        <p:menuitem value="Доп.сведения" action="newOrderLines" url="newOrderLines"/>
                        <p:menuitem value="Дополнения" />
                        <p:menuitem value="Позиции" />
                        <p:menuitem value="Подтверждение" />
                    </p:steps>   
                    <h:panelGrid columns="4" cellpadding="7" cellspacing="7">


                        <p:outputLabel value="Заказчик"/>
                        <p:autoComplete value="#{createSaleOrderFlow.order.customer}" maxResults="20"
                                        completeMethod="#{customerConverter.completeItem}"
                                        var="m" itemLabel="#{m.name}" size="70"
                                        itemValue="#{m}" converter="#{customerConverter}" 
                                        forceSelection="true">
                            <p:ajax event="itemSelect" listener="#{orderCBean.clearFieldsHeader()}" update="shp ashp rwshp inv ainv"/>
                        </p:autoComplete>    

                        <p:outputLabel value="Номер заказа" />
                        <p:outputLabel id="orderNumber" value="#{createSaleOrderFlow.order.header_id}" />

                        <p:outputLabel value="Номер PO клиента" />
                        <p:inputText  value="#{createSaleOrderFlow.order.cust_po_number}" maxlength="12" size="10" style="text-align: right "/>
                        
                        <p:outputLabel value="Автор"/>
                        <p:outputLabel value="#{sessionActions.currentUser.fullName}"/>

                        <p:outputLabel value="Грузополучатель"/>
                        <p:autoComplete id="shp" value="#{createSaleOrderFlow.order.shp_customer}" maxResults="20"
                                        completeMethod="#{customerConverter.completeSHP}"
                                        var="m" itemLabel="#{m.name}" size="70"
                                        itemValue="#{m}" converter="#{customerConverter}" 
                                        forceSelection="true" dropdown="true">
                            <p:ajax event="itemSelect" listener="#{createSaleOrderFlow.order.setShp_address(null)}" update="ashp rwshp"/>
                        </p:autoComplete>    

                        <p:outputLabel value="Валюта"/>
                        <p:autoComplete  size="5" value="#{createSaleOrderFlow.order.currency}" 
                                         completeMethod="#{currencyLOV.completeItem}" 
                                         forceSelection="true" dropdown="true" />


                        <p:outputLabel value="Адрес грузополучателя"/>
                        <p:autoComplete id="ashp" value="#{createSaleOrderFlow.order.shp_address}" 
                                        maxResults="20"
                                        completeMethod="#{addressConverter.completeAddressSHP}" size="70"
                                        var="m" 
                                        itemValue="#{m}" 
                                        itemLabel="#{m.country.getTranslateObject(sessionActions.language).getName()} #{m.postCode} #{m.region} #{m.city} #{m.fullAddress}" 
                                        converter="#{addressConverter}" 
                                        forceSelection="true" dropdown="true">
                            <p:ajax event="itemSelect" listener="#{createSaleOrderFlow.order.setShp_rwaddress(null)}" update="rwshp"/>
                        </p:autoComplete> 

                        <p:outputLabel value="Пункт поставки"/>
                        <p:autoComplete size="30" value="#{createSaleOrderFlow.order.fob}" 
                                        completeMethod="#{fobLOV.completeItem}" var="m" maxResults="20"
                                        forceSelection="true" itemValue="#{m}" 
                                        itemLabel="#{m}"
                                        dropdown="true"/>

                        <p:outputLabel value="ЖД реквизиты"/>
                        <p:autoComplete id="rwshp" value="#{createSaleOrderFlow.order.shp_rwaddress}" 
                                        maxResults="20"
                                        completeMethod="#{RWAddressConverter.completeRWAddress}" size="70"
                                        var="m" 
                                        itemValue="#{m}" 
                                        itemLabel="#{m.station.getTranslateObject(sessionActions.language).getName()} #{m.rwrcvcode} #{m.rwbranch}" 
                                        converter="#{RWAddressConverter}" 
                                        forceSelection="true" dropdown="true">
                        </p:autoComplete>

                        <p:outputLabel value="Условие поставки"/>
                        <p:autoComplete size="10" value="#{createSaleOrderFlow.order.freightTerm}" 
                                        completeMethod="#{freightTermLOV.completeItem}" var="m" maxResults="20"
                                        forceSelection="true" itemValue="#{m}" 
                                        itemLabel="#{m}"
                                        dropdown="true"/>

                        <p:outputLabel value="Контрактодержатель"/>
                        <p:autoComplete id="inv" value="#{createSaleOrderFlow.order.inv_customer}" maxResults="20"
                                        completeMethod="#{customerConverter.completeINV}"
                                        var="m" itemLabel="#{m.name}" size="70"
                                        itemValue="#{m}" converter="#{customerConverter}" 
                                        forceSelection="true" dropdown="true">
                            <p:ajax event="itemSelect" listener="#{createSaleOrderFlow.order.setInv_address(null)}" update="ainv"/>
                        </p:autoComplete> 

                        <p:outputLabel value="Автор"/>
                        <p:outputLabel value="#{sessionActions.currentUser.fullName}"/>

                        <p:outputLabel value="Адрес контрактодержателя"/>
                        <p:autoComplete id="ainv" value="#{createSaleOrderFlow.order.inv_address}" 
                                        maxResults="20"
                                        completeMethod="#{addressConverter.completeAddressINV}" size="70"
                                        var="m" 
                                        itemValue="#{m}" 
                                        itemLabel="#{m.country.getTranslateObject(sessionActions.language).getName()} #{m.postCode} #{m.region} #{m.city} #{m.fullAddress}" 
                                        converter="#{addressConverter}" 
                                        forceSelection="true" dropdown="true"/>
                    </h:panelGrid>
                    <p:commandButton value="Lines" action="newOrderLines"/>
                    <p:commandButton value="Cancel" action="goHome" immediate="true"/>
                </h:form>
            </ui:define>

        </ui:composition>

    </body>
</html>
